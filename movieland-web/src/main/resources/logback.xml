<?xml version="1.0" encoding="UTF-8"?>
<configuration debug="false">

       <property name="LOGS" value="D:/logs" />

       <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
              <encoder>
                     <Pattern>%d{HH:mm:ss.SSS} %X{requestId} %X{userLogin} [%thread] %-5level %logger{36} - %msg%n</Pattern>
              </encoder>
       </appender>

       <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
              <file>${LOGS}/movieland.log</file>
              <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
                     <!-- rollover daily -->
                     <fileNamePattern>${LOGS}/archived/movieland.%d{yyyy-MM-dd}.log.%i</fileNamePattern>
                     <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
                            <maxFileSize>5MB</maxFileSize>
                     </timeBasedFileNamingAndTriggeringPolicy>
              </rollingPolicy>

              <encoder>
                     <Pattern>%d{HH:mm:ss.SSS} %X{requestId} %X{userLogin} [%thread] %-5level %logger{36} - %msg%n</Pattern>
              </encoder>
       </appender>

       <appender name="EMAIL" class="ch.qos.logback.classic.net.SMTPAppender">
              <smtpHost>smtp.gmail.com</smtpHost>
              <smtpPort>465</smtpPort>
              <ssl>true</ssl>
              <starttls>true</starttls>
              <username>andrii.logger@gmail.com</username>
              <password>QAZWSX123</password>
              <to>andrii.logger@gmail.com</to>
              <from>andrii.logger@gmail.com</from>
              <subject>Movieland Error: %logger{20} - %m</subject>

              <layout class="ch.qos.logback.classic.html.HTMLLayout" />
              <!-- by default, outgoing message size is 256 (messages logged by SMTPAppender) but you can your own buffer size.  -->
              <cyclicBufferTracker class="ch.qos.logback.core.spi.CyclicBufferTrackerImpl">
                     <!-- send just one log entry per email -->
                     <bufferSize>100</bufferSize>
              </cyclicBufferTracker>

       </appender>

       <root level="DEBUG">
              <appender-ref ref="STDOUT" />
              <appender-ref ref="FILE" />
       </root>

       <root level="error">
              <appender-ref ref="STDOUT" />
              <appender-ref ref="EMAIL" />
       </root>
</configuration>
